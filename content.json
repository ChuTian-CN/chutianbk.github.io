{"meta":{"title":"楚天","subtitle":"","description":"","author":"ChuTian","url":"https://chutianbk.github.io","root":"/"},"pages":[{"title":"都是apt大佬","date":"2019-12-16T04:11:49.417Z","updated":"2019-12-16T04:11:49.413Z","comments":true,"path":"friends/index.html","permalink":"https://chutianbk.github.io/friends/index.html","excerpt":"","text":"互挂友链加我好友私信"},{"title":"关于","date":"2019-12-10T10:30:46.611Z","updated":"2019-12-10T10:30:46.608Z","comments":true,"path":"about/index.html","permalink":"https://chutianbk.github.io/about/index.html","excerpt":"","text":""},{"title":"404 Not Found","date":"2019-12-10T10:32:06.829Z","updated":"2019-12-10T10:32:06.825Z","comments":true,"path":"404.html","permalink":"https://chutianbk.github.io/404.html","excerpt":"","text":"404 Not Found **很抱歉，您访问的页面不存在** 可能是输入地址有误或该地址已被删除"},{"title":"所有分类","date":"2019-12-11T02:16:45.296Z","updated":"2019-12-11T02:16:45.296Z","comments":true,"path":"categories/index.html","permalink":"https://chutianbk.github.io/categories/index.html","excerpt":"","text":""},{"title":"工具功能即将上线","date":"2019-12-11T06:51:22.105Z","updated":"2019-12-11T06:51:22.098Z","comments":true,"path":"tags/index.html","permalink":"https://chutianbk.github.io/tags/index.html","excerpt":"","text":""},{"title":"guestbook","date":"2019-12-11T03:28:01.000Z","updated":"2019-12-11T03:29:56.897Z","comments":true,"path":"guestbook/index.html","permalink":"https://chutianbk.github.io/guestbook/index.html","excerpt":"","text":""},{"title":"404 Not Found","date":"2019-12-11T06:43:27.236Z","updated":"2019-12-11T01:40:34.905Z","comments":true,"path":"admin/index.html","permalink":"https://chutianbk.github.io/admin/index.html","excerpt":"","text":"404 Not Found **检测到你的ip无法访问** 请换成Longyearbyen的地址"}],"posts":[{"title":"关于Windows的一些特性","slug":"03","date":"2019-12-26T08:07:15.000Z","updated":"2019-12-26T08:37:01.699Z","comments":true,"path":"2019/12/26/03/","link":"","permalink":"https://chutianbk.github.io/2019/12/26/03/","excerpt":"","text":"部分图片看不清可右键新建标签页查看一、先介绍两条命令吧1.query user命令查询用户命令：query user在输入这一条命令后，会显示计算机机名或域，后面跟用户名。 2.第二条 tscon切换会话命令Windows系统下，tscon可被用来切换远程桌面的会话。正常情况下，切换会话时需要提供登录密码，但通过特殊的利用方法能够绕过验证，不输入密码实现未授权登录。该命令具体用法如下 二、使用场景一 先创建一个用户，然后远程桌面登录到新创建的用户。 使用query user查询已登录的用户。 接着使用tscon ID号 /PASSWORD:该ID所对应的密码进行切换 1tscon 2 &#x2F;PASSWORD:******* 回车之后，就切换到了administrator的远程桌面 三、使用场景二由于Windows的一些特性，若是在System权限执行同样的命令的时候，将会绕过输入密码的过程。 可见上图执行失败了，虽然是以管理员权限运行的CMD，但是还是以chutian这个用户名去打开的，并不是System权限。需要进行更进一步的提权。 提权这里使用的是incognito提权（还有很多其他方法，自行百度，不一一举例了） 使用System权限进行切换 1tscon ‘ID号’ 可见，无需输入密码，直接切换了 四、使用场景三比如在渗透过程中，可以利用辅助工具管理器后门（如放大镜后门）绕过系统登陆界面 通过注册表劫持实现后门，修改注册表的命令如下： 1REG ADD &quot;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe&quot; &#x2F;t REG_SZ &#x2F;v Debugger &#x2F;d &quot;C:\\windows\\system32\\cmd.exe&quot; &#x2F;f 使用快捷键win+u调出CMD窗口 两个会话都可以切换 成功进入 五、备注：所使用的提权软件： 链接：https://pan.baidu.com/s/1WsCczfnmKue0t5P0_STmNw提取码：kzxb复制这段内容后打开百度网盘手机App，操作更方便哦 软件来源于互联网，后门自测","categories":[{"name":"渗透","slug":"渗透","permalink":"https://chutianbk.github.io/categories/%E6%B8%97%E9%80%8F/"}],"tags":[]},{"title":"使用L2TP拨号上网","slug":"02","date":"2019-12-16T02:27:04.000Z","updated":"2019-12-16T06:11:22.279Z","comments":true,"path":"2019/12/16/02/","link":"","permalink":"https://chutianbk.github.io/2019/12/16/02/","excerpt":"","text":"什么是L2TP​ L2TP是一种工业标准的Internet隧道协议，功能大致和PPTP协议类似，比如同样可以对网络数据流进行加密。不过也有不同之处，比如PPTP要求网络为IP网络，L2TP要求面向数据包的点对点连接；PPTP使用单一隧道，L2TP使用多隧道；L2TP提供包头压缩、隧道验证，而PPTP不支持。 如何搭建IPsec VPN1.首先需要购买一个VPS服务器（必须要是linux的），我这里用的是VULTR的，操作系统装Ubuntu 和 Debian，或者CentOS. 2.使用一键部署脚本 Ubuntu and Debian. 1wget https:&#x2F;&#x2F;git.io&#x2F;vpnsetup -O vpnsetup.sh &amp;&amp; sudo sh vpnsetup.sh CentOS. 1wget https:&#x2F;&#x2F;git.io&#x2F;vpnsetup-centos -O vpnsetup.sh &amp;&amp; sudo sh vpnsetup.sh 慢慢等待自动部署。 成功后的效果图： 将后面4项全部复制出来保存好Server IP: IPsec PSK: Username: Password: Windows设置VPN拨号打开网络和Internet设置➡VPN➡添加VPN连接 接下来在VPN提供商选择Windows内置，VPN类型选择使用预共享密钥的L2TP/IPsec，然后连接名称随便填，服务器名称或地址填VPS的IP，密钥：IPsec PSK:,然后加上username和password.（就是上面保存的）。都填完后选择保存。 接下来在右下角找到连接就可以拨号VPN了 连接问题第一次拨号可能会出现失败的情况，需要修改注册表解决 将下复制： 1Windows Registry Editor Version 5.002[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\RasMan\\Parameters]3&quot;ProhibitIpSec&quot;&#x3D;dword:000000004[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PolicyAgent]5&quot;AssumeUDPEncapsulationContextOnSendRule&quot;&#x3D;dword:00000002 放到记事本，并将后缀改为.reg 管理员权限运行，再次进行拨号就可拨上了 成功连接 GitHub地址：https://github.com/hwdsl2/setup-ipsec-vpn/blob/master/README-zh.md","categories":[{"name":"脚本","slug":"脚本","permalink":"https://chutianbk.github.io/categories/%E8%84%9A%E6%9C%AC/"}],"tags":[]},{"title":"看我如何拿下BC站的服务器","slug":"01","date":"2019-12-10T03:43:56.000Z","updated":"2019-12-10T10:38:16.078Z","comments":true,"path":"2019/12/10/01/","link":"","permalink":"https://chutianbk.github.io/2019/12/10/01/","excerpt":"","text":"一、信息收集拿到目标网站，可见是一个很常规的bc站。 先进行简单的信息收集，通过Wappalyzer插件可见php版本与windows serve这两个比较重要的信息 命令行nslookup+url查看ip,发现没有CDN 再到爱站上看看 嗯，柬埔寨可还行 知道ip地址后端口扫描一波（全端口扫描+服务探测。这个过程比较漫长，可以先干别的） 在扫描之余尝试3389连接远程桌面（因为开始已经看到是windows serve的服务器） 试了两次，猜测是修改端口了，或者是登录ip白名单？ 二、后台爆破回到web，反手在url后面加一个admin 后台出来了，这bc有点水啊，随手测了几个弱口令，无果 发现没有验证码校验，抓包爆破一波 通常找一些常规的弱口令进行爆破就够了 秒出密码：123456，我吐了，他们运维可能要被打死 三、寻找上传点这么简单就拿下了后台，我们当然不会满足。 大致浏览了一下后台的各个功能，寻找可以利用的地方，在系统管理处找到一处上传点 （有没有表哥发收款码过来，暴富的机会来了！） 随便写一个一句话，并将后缀改成.jpg并且抓包发送到Repeater查看 提示“不是真正的图片类型” ，在包内改成php后缀，提示非法文件类型 感觉是白名单+文件头校验，尝试图片马 尝试了几波，白名单限制得很死，没绕过去 顿时陷入了僵局，还是另外寻找突破口吧 四、峰回路转认真想了一下，它是Windows，而Windows的主流建站工具，宝塔，护卫神，phpstudy，upupw。之前看到它的php版本是5.2.17，正好想到前段时间爆出的phpstudy的2个后门，后门存在于php-5.4.45和php-5.2.17两个版本中。马上测试一波 请求包中Accept-Encoding: gzip, deflate,将gzip,deflate中间的空格删掉 并在下面加上一句：Accept-Charset:+所执行命令的base64编码 我惊呆了，真的是用phpstudy建站的，这站长心也太大了吧,接下来的事情就好办多了。 五、蚁剑无文件shell连接之 编码器记得改成base64 然后将一句话进行base64编码，复制到 Accept-Charset:后面 修改蚁剑内的请求信息，处Header头修改如图下 测试连接，成功连接上 发现直接是SYSTEM权限，这就好玩了 六、上传mimikatz抓取Hash 新建目录，上传winrar.exe +mimikatz 使用上传的winrar解压，命令：winrar.exe e x64.rar 运行mimi.bat,这里说一下下图后面最好加上一个exit，不然的话mimikatz会不断的写日志，导致log文件越来越大,当时就犯了这样一个错误 将生成的mimikatz.log复制到网站根目录下,然后去查看 成功抓到管理员的RDP的密码。 回头看看之前扫的全端口也扫好了 可见总共开了三个端口，一般更改了3389端口 用nmap扫描加 -sV参数后，扫出的rdp服务,一般service会显示为 ssl/unknown. 尝试远程桌面连接 嘻嘻，成功登录，拿下服务器，随即点了根烟，将所有证据打包好，掏出了手机拨打110 七、总结在我们拿下webshell的时候，想要获取数据或者源码往往会用菜刀或者蚁剑去打包，但是这个时候往往就会出现很多问题，列如打包失败，或者是打包得不完整等等。 这个时候如果对方是windows服务器的话，我们可以将我们本地装的winrar.exe上传过去 压缩盘下的dat文件夹，并且命名为bat.rarwinrar.exe a -ag -k -r -s -ibck c:/bak.rar c:/dat/ 压缩多个文件winrar a -ag -ibck bak.rar filename1 filename2 filename.... 参数说明：a :备份所有文件；-ag :当创建压缩文件时，以格式“YYYYMMDDHHMMSS”附加当前日期字符串,文件名bakYYYYMMDDHHMMSS.rar；-k :锁定压缩文件；-r:备份目录和子目录；-s :创建固实压缩文件；-ibck:后台运行； filename1：要压缩的文件名，可以多个，也可用通配符file*","categories":[{"name":"渗透","slug":"渗透","permalink":"https://chutianbk.github.io/categories/%E6%B8%97%E9%80%8F/"}],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2019-12-09T06:14:57.185Z","updated":"2019-12-09T06:14:57.185Z","comments":true,"path":"2019/12/09/hello-world/","link":"","permalink":"https://chutianbk.github.io/2019/12/09/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}